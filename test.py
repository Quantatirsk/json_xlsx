"""
测试json_xlsx库
"""

import requests
from json_xlsx import convert_json_to_excel

# 获取响应数据
response = requests.get("https://dummyjson.com/recipes", timeout=10)
response_data = response.json()

# 获取第一个key的值
json_data = response_data.get(list(response_data.keys())[0])

json_data = [
        {
            "合同编号": "CONTRACT-2025-IT-001",
            "合同名称": "企业数字化转型系统开发项目",
            "合同类型": "技术开发合同",
            "签署日期": "2025-06-01",
            "生效日期": "2025-06-15",
            "到期日期": "2026-12-31",
            "合同状态": "执行中",
            "合同金额": {
                "总金额": 2800000.00,
                "币种": "人民币",
                "税率": 0.06,
                "税额": 168000.00,
                "含税总额": 2968000.00
            },
            "甲方信息": {
                "公司名称": "北京创新科技集团有限公司",
                "统一社会信用代码": "91110000123456789A",
                "法定代表人": {
                    "姓名": "张强",
                    "身份证号": "110101198501011234",
                    "联系电话": "13800138001"
                },
                "注册地址": {
                    "省份": "北京市",
                    "城市": "北京市",
                    "区县": "海淀区",
                    "详细地址": "中关村科技园区创新大厦15层",
                    "邮政编码": "100080"
                },
                "联系信息": {
                    "办公电话": "010-62345678",
                    "传真": "010-62345679",
                    "邮箱": "contract@bjtech.com",
                    "网站": "https://www.bjtech.com"
                },
                "财务信息": {
                    "开户银行": "中国工商银行北京海淀支行",
                    "银行账号": "6222021234567890123",
                    "纳税人识别号": "91110000123456789A"
                }
            },
            "乙方信息": {
                "公司名称": "上海智慧软件开发有限公司",
                "统一社会信用代码": "91310000987654321B",
                "法定代表人": {
                    "姓名": "李明",
                    "身份证号": "310101198703051234",
                    "联系电话": "13900139001"
                },
                "注册地址": {
                    "省份": "上海市",
                    "城市": "上海市",
                    "区县": "浦东新区",
                    "详细地址": "陆家嘴金融贸易区世纪大道1000号",
                    "邮政编码": "200120"
                },
                "联系信息": {
                    "办公电话": "021-58765432",
                    "传真": "021-58765433",
                    "邮箱": "business@shsoft.com",
                    "网站": "https://www.shsoft.com"
                },
                "财务信息": {
                    "开户银行": "中国建设银行上海浦东支行",
                    "银行账号": "6227001234567890123",
                    "纳税人识别号": "91310000987654321B"
                },
                "资质信息": {
                    "软件企业认定证书": "沪R-2024-0123",
                    "ISO9001认证": "ISO9001:2023-SH-456",
                    "CMMI等级": "CMMI5级",
                    "高新技术企业证书": "GR202431000123"
                }
            },
            "项目详情": {
                "项目背景": "甲方需要建设全面的数字化转型平台，提升企业运营效率",
                "项目目标": [
                    "建立统一的数据管理平台",
                    "实现业务流程数字化",
                    "提升决策分析能力",
                    "降低运营成本20%以上"
                ],
                "交付物": [
                    {
                        "名称": "需求分析报告",
                        "描述": "详细的业务需求和技术需求分析文档",
                        "交付时间": "2025-07-15",
                        "责任人": "李明",
                        "验收标准": "甲方业务部门确认需求完整性和准确性"
                    },
                    {
                        "名称": "系统架构设计",
                        "描述": "包含技术架构、数据架构、应用架构的设计文档",
                        "交付时间": "2025-08-30",
                        "责任人": "王技术",
                        "验收标准": "技术架构评审通过，满足性能和安全要求"
                    },
                    {
                        "名称": "核心系统开发",
                        "描述": "数据管理平台、业务流程引擎、分析决策系统",
                        "交付时间": "2026-03-31",
                        "责任人": "开发团队",
                        "验收标准": "功能测试、性能测试、安全测试全部通过"
                    },
                    {
                        "名称": "系统集成测试",
                        "描述": "与现有系统的集成测试和端到端测试",
                        "交付时间": "2026-05-31",
                        "责任人": "测试团队",
                        "验收标准": "集成测试通过率达到99.5%以上"
                    },
                    {
                        "名称": "用户培训和上线",
                        "描述": "用户操作培训、系统上线部署、运维交接",
                        "交付时间": "2026-07-31",
                        "责任人": "实施团队",
                        "验收标准": "用户培训合格率95%以上，系统稳定运行30天"
                    }
                ],
                "技术要求": {
                    "开发语言": ["Java", "Python", "JavaScript"],
                    "数据库": ["MySQL", "Redis", "Elasticsearch"],
                    "框架技术": ["Spring Boot", "Vue.js", "Docker", "Kubernetes"],
                    "性能要求": {
                        "并发用户数": 10000,
                        "响应时间": "< 2秒",
                        "可用性": "99.9%",
                        "数据处理能力": "1TB/日"
                    },
                    "安全要求": {
                        "数据加密": "AES-256",
                        "传输加密": "TLS 1.3",
                        "访问控制": "RBAC权限模型",
                        "审计日志": "完整操作日志记录"
                    }
                }
            },
            "付款条款": {
                "付款方式": "分期付款",
                "付款计划": [
                    {
                        "阶段": "合同签署",
                        "付款比例": 0.20,
                        "付款金额": 560000.00,
                        "预期付款日期": "2025-06-15",
                        "付款条件": "合同正式签署后7个工作日内",
                        "状态": "已支付",
                        "实际付款日期": "2025-06-12"
                    },
                    {
                        "阶段": "需求确认完成",
                        "付款比例": 0.15,
                        "付款金额": 420000.00,
                        "预期付款日期": "2025-07-22",
                        "付款条件": "需求分析报告验收通过后7个工作日内",
                        "状态": "待支付"
                    },
                    {
                        "阶段": "系统开发完成",
                        "付款比例": 0.30,
                        "付款金额": 840000.00,
                        "预期付款日期": "2026-04-07",
                        "付款条件": "核心系统开发完成并通过测试后7个工作日内",
                        "状态": "未到期"
                    },
                    {
                        "阶段": "系统上线运行",
                        "付款比例": 0.25,
                        "付款金额": 700000.00,
                        "预期付款日期": "2026-08-07",
                        "付款条件": "系统正式上线并稳定运行30天后7个工作日内",
                        "状态": "未到期"
                    },
                    {
                        "阶段": "质保期结束",
                        "付款比例": 0.10,
                        "付款金额": 280000.00,
                        "预期付款日期": "2027-07-31",
                        "付款条件": "一年质保期结束，无重大问题后7个工作日内",
                        "状态": "未到期"
                    }
                ],
                "发票要求": {
                    "发票类型": "增值税专用发票",
                    "开票信息": "按付款进度分期开票",
                    "开票时限": "收到付款后3个工作日内"
                }
            },
            "风险条款": {
                "延期风险": {
                    "甲方原因延期": "不承担违约责任，相应顺延后续里程碑",
                    "乙方原因延期": "每延期一天按合同总额的0.5‰承担违约金",
                    "不可抗力延期": "双方协商处理，不承担违约责任"
                },
                "质量风险": {
                    "质量保证": "提供1年免费质保服务",
                    "缺陷处理": "重大缺陷24小时内响应，一般缺陷72小时内响应",
                    "赔偿上限": "违约赔偿总额不超过合同总金额的30%"
                },
                "知识产权": {
                    "成果归属": "定制开发成果归甲方所有",
                    "第三方IP": "乙方保证不侵犯第三方知识产权",
                    "IP风险": "因IP问题产生的损失由乙方承担"
                }
            },
            "审批流程": {
                "发起人": {
                    "姓名": "张三",
                    "部门": "信息技术部",
                    "职位": "部门经理",
                    "发起时间": "2025-05-15",
                    "发起原因": "业务数字化转型需要"
                },
                "审批记录": [
                    {
                        "审批人": "李四",
                        "审批角色": "技术总监",
                        "审批时间": "2025-05-18",
                        "审批意见": "技术方案可行，同意执行",
                        "审批状态": "同意"
                    },
                    {
                        "审批人": "王五",
                        "审批角色": "财务总监",
                        "审批时间": "2025-05-20",
                        "审批意见": "预算合理，资金充足，同意执行",
                        "审批状态": "同意"
                    },
                    {
                        "审批人": "赵六",
                        "审批角色": "总经理",
                        "审批时间": "2025-05-22",
                        "审批意见": "符合公司战略规划，授权签署",
                        "审批状态": "同意"
                    }
                ],
                "最终批准": {
                    "批准人": "赵六",
                    "批准时间": "2025-05-22",
                    "授权范围": "完全授权，可直接签署"
                }
            },
            "变更记录": [
                {
                    "变更编号": "CHANGE-001",
                    "变更日期": "2025-05-25",
                    "变更类型": "技术需求调整",
                    "变更描述": "增加移动端支持功能",
                    "变更原因": "业务发展需要支持移动办公",
                    "影响分析": {
                        "时间影响": "增加2个月开发时间",
                        "成本影响": "增加费用200,000元",
                        "风险影响": "技术难度略有增加"
                    },
                    "变更决策": "同意变更",
                    "决策人": "张强",
                    "生效状态": "已生效"
                }
            ],
            "附件信息": [
                {
                    "附件名称": "技术需求规格说明书",
                    "文件类型": "PDF",
                    "文件大小": "2.5MB",
                    "上传时间": "2025-05-10",
                    "上传人": "张三",
                    "文件说明": "详细的技术需求和功能规格"
                },
                {
                    "附件名称": "投标技术方案",
                    "文件类型": "DOCX",
                    "文件大小": "8.3MB",
                    "上传时间": "2025-05-12",
                    "上传人": "李明",
                    "文件说明": "乙方提交的详细技术实现方案"
                },
                {
                    "附件名称": "项目预算明细表",
                    "文件类型": "XLSX",
                    "文件大小": "1.2MB",
                    "上传时间": "2025-05-14",
                    "上传人": "财务部",
                    "文件说明": "项目各阶段详细预算分解"
                }
            ],
            "元数据": {
                "创建时间": "2025-05-15T09:30:00",
                "最后更新": "2025-06-01T16:45:00",
                "创建人": "张三",
                "最后更新人": "合同管理员",
                "数据版本": "1.2",
                "同步状态": "已同步",
                "备份状态": "已备份",
                "权限等级": "机密"
            }
        },
        
        # 第二个合同 - 采购合同
        {
            "合同编号": "CONTRACT-2025-PR-002",
            "合同名称": "办公设备及IT硬件采购合同",
            "合同类型": "采购合同",
            "签署日期": "2025-06-05",
            "生效日期": "2025-06-10",
            "到期日期": "2025-12-31",
            "合同状态": "执行中",
            "合同金额": {
                "总金额": 1560000.00,
                "币种": "人民币",
                "税率": 0.13,
                "税额": 202800.00,
                "含税总额": 1762800.00
            },
            "甲方信息": {
                "公司名称": "北京创新科技集团有限公司",
                "统一社会信用代码": "91110000123456789A",
                "采购联系人": {
                    "姓名": "刘采购",
                    "部门": "采购部",
                    "职位": "采购主管",
                    "联系电话": "13700137001",
                    "邮箱": "procurement@bjtech.com"
                }
            },
            "乙方信息": {
                "公司名称": "深圳优质IT设备供应有限公司",
                "统一社会信用代码": "91440300555666777C",
                "法定代表人": {
                    "姓名": "陈供应",
                    "身份证号": "440301198506101234",
                    "联系电话": "13500135001"
                },
                "销售联系人": {
                    "姓名": "林销售",
                    "部门": "销售部",
                    "职位": "大客户经理",
                    "联系电话": "13600136001",
                    "邮箱": "sales@szit.com"
                },
                "资质认证": [
                    "ISO9001质量管理体系认证",
                    "3C强制性产品认证",
                    "高新技术企业认定",
                    "AAA级信用企业"
                ]
            },
            "采购清单": [
                {
                    "类别": "笔记本电脑",
                    "型号规格": "Dell Latitude 7430",
                    "配置描述": "i7-1255U/16GB/512GB SSD/14寸/Win11",
                    "数量": 50,
                    "单价": 8500.00,
                    "小计": 425000.00,
                    "质保期": "3年",
                    "交付要求": "原装正品，含发票"
                },
                {
                    "类别": "台式机",
                    "型号规格": "HP EliteDesk 800 G9",
                    "配置描述": "i5-12500/8GB/256GB SSD/集显/Win11",
                    "数量": 30,
                    "单价": 4200.00,
                    "小计": 126000.00,
                    "质保期": "3年",
                    "交付要求": "含显示器、键盘、鼠标"
                },
                {
                    "类别": "显示器",
                    "型号规格": "Dell U2422H",
                    "配置描述": "24寸 IPS 1920x1080 USB-C",
                    "数量": 80,
                    "单价": 1800.00,
                    "小计": 144000.00,
                    "质保期": "3年",
                    "交付要求": "支持USB-C一线连接"
                },
                {
                    "类别": "网络设备",
                    "型号规格": "Cisco Catalyst 2960-X",
                    "配置描述": "48端口千兆交换机",
                    "数量": 8,
                    "单价": 12000.00,
                    "小计": 96000.00,
                    "质保期": "5年",
                    "交付要求": "含机架安装套件"
                },
                {
                    "类别": "服务器",
                    "型号规格": "Dell PowerEdge R450",
                    "配置描述": "Xeon Silver 4314/32GB/2TB*2/RAID1",
                    "数量": 4,
                    "单价": 45000.00,
                    "小计": 180000.00,
                    "质保期": "5年",
                    "交付要求": "包含安装调试服务"
                },
                {
                    "类别": "办公设备",
                    "子类别": [
                        {
                            "名称": "多功能打印机",
                            "型号": "HP LaserJet Pro MFP M428fdw",
                            "数量": 15,
                            "单价": 2800.00,
                            "小计": 42000.00
                        },
                        {
                            "名称": "高速扫描仪",
                            "型号": "Fujitsu ScanSnap iX1600",
                            "数量": 8,
                            "单价": 3200.00,
                            "小计": 25600.00
                        },
                        {
                            "名称": "投影仪",
                            "型号": "Epson CB-FH52",
                            "数量": 12,
                            "单价": 8500.00,
                            "小计": 102000.00
                        }
                    ],
                    "类别小计": 169600.00
                }
            ],
            "交付安排": {
                "总体要求": "分批交付，确保业务连续性",
                "交付批次": [
                    {
                        "批次编号": "BATCH-001",
                        "交付日期": "2025-07-15",
                        "交付内容": ["笔记本电脑 30台", "显示器 50台", "打印机 10台"],
                        "交付地点": "北京海淀办公区",
                        "验收负责人": "IT部-王工程师",
                        "特殊要求": "需提前3天预约，安排技术人员现场安装"
                    },
                    {
                        "批次编号": "BATCH-002",
                        "交付日期": "2025-08-30",
                        "交付内容": ["台式机 30台", "显示器 30台", "网络设备 8台"],
                        "交付地点": "北京海淀办公区",
                        "验收负责人": "IT部-王工程师",
                        "特殊要求": "网络设备需要厂家工程师现场配置"
                    },
                    {
                        "批次编号": "BATCH-003",
                        "交付日期": "2025-09-30",
                        "交付内容": ["笔记本电脑 20台", "服务器 4台", "其他办公设备"],
                        "交付地点": "北京海淀数据中心",
                        "验收负责人": "IT部-李运维",
                        "特殊要求": "服务器需要完成系统安装和配置"
                    }
                ],
                "验收标准": {
                    "外观检查": "无破损、无划痕、包装完整",
                    "功能测试": "所有功能正常，性能达到规格要求",
                    "配件检查": "配件齐全，符合清单要求",
                    "文档要求": "提供产品合格证、保修卡、用户手册"
                }
            },
            "服务条款": {
                "技术支持": {
                    "支持方式": ["电话支持", "远程支持", "现场支持"],
                    "响应时间": {
                        "一般问题": "4小时内响应",
                        "紧急问题": "1小时内响应",
                        "系统瘫痪": "30分钟内响应"
                    },
                    "支持时间": "工作日 9:00-18:00，紧急情况7x24小时"
                },
                "培训服务": {
                    "培训内容": "设备使用、维护保养、故障排除",
                    "培训方式": "现场培训 + 在线培训",
                    "培训时长": "每批次设备交付后提供4小时培训",
                    "培训人员": "厂家认证工程师"
                },
                "维护保养": {
                    "保养频率": "每季度一次预防性维护",
                    "保养内容": "清洁、检查、性能优化、配件更换",
                    "保养报告": "每次保养后提供详细报告"
                }
            },
            "付款条款": {
                "付款方式": "银行转账",
                "付款计划": [
                    {
                        "阶段": "合同签署",
                        "付款比例": 0.30,
                        "付款金额": 468000.00,
                        "付款条件": "合同签署后5个工作日内",
                        "状态": "已支付"
                    },
                    {
                        "阶段": "第一批设备验收",
                        "付款比例": 0.30,
                        "付款金额": 468000.00,
                        "付款条件": "第一批设备验收合格后5个工作日内",
                        "状态": "待验收"
                    },
                    {
                        "阶段": "第二批设备验收",
                        "付款比例": 0.30,
                        "付款金额": 468000.00,
                        "付款条件": "第二批设备验收合格后5个工作日内",
                        "状态": "未到期"
                    },
                    {
                        "阶段": "最终验收完成",
                        "付款比例": 0.10,
                        "付款金额": 156000.00,
                        "付款条件": "所有设备验收完成并稳定运行30天后",
                        "状态": "未到期"
                    }
                ]
            },
            "审批流程": {
                "发起人": {
                    "姓名": "刘采购",
                    "部门": "采购部",
                    "发起时间": "2025-05-20"
                },
                "审批记录": [
                    {
                        "审批人": "IT部经理",
                        "审批时间": "2025-05-22",
                        "审批意见": "设备配置符合需求，同意采购",
                        "审批状态": "同意"
                    },
                    {
                        "审批人": "财务总监",
                        "审批时间": "2025-05-25",
                        "审批意见": "预算充足，价格合理，同意支付",
                        "审批状态": "同意"
                    }
                ]
            },
            "元数据": {
                "创建时间": "2025-05-20T14:20:00",
                "最后更新": "2025-06-05T11:30:00",
                "创建人": "刘采购",
                "数据版本": "1.0",
                "归档状态": "在档"
            }
        }
    ]



# 配置表头背景色和字体颜色
CONFIG = {"header_background_color": "FFFFFF", "header_font_color": "000000"}

# 输出路径
OUTPUT_PATH = "sample.xlsx" 

# 转换数据
result = convert_json_to_excel(json_data, OUTPUT_PATH, CONFIG)

# 打印输出路径
print(result["output_path"])
